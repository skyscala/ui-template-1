aW1wb3J0IHtDb21wb25lbnR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnOwppbXBvcnQge01lc3NhZ2UsIE1lc3NhZ2VTZXJ2aWNlfSBmcm9tICdwcmltZW5nL2FwaSc7CmltcG9ydCB7QnJlYWRjcnVtYlNlcnZpY2V9IGZyb20gJy4uLy4uL2FwcC5icmVhZGNydW1iLnNlcnZpY2UnOwoKQENvbXBvbmVudCh7CiAgICB0ZW1wbGF0ZVVybDogJy4vbWVzc2FnZXNkZW1vLmNvbXBvbmVudC5odG1sJywKICAgIHN0eWxlczogW2AKICAgICAgICA6aG9zdCA6Om5nLWRlZXAgLnAtYnV0dG9uIHsKICAgICAgICAgICAgbWluLXdpZHRoOiA4ZW07CiAgICAgICAgfQoKCQk6aG9zdCA6Om5nLWRlZXAgLnAtbWVzc2FnZSB7CgkJCW1hcmdpbi1sZWZ0OiAuMjVlbTsKCQl9CiAgICBgXSwKICAgIHByb3ZpZGVyczogW01lc3NhZ2VTZXJ2aWNlXQp9KQpleHBvcnQgY2xhc3MgTWVzc2FnZXNEZW1vQ29tcG9uZW50IHsKCiAgICBtc2dzOiBNZXNzYWdlW10gPSBbXTsKCiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNlcnZpY2U6IE1lc3NhZ2VTZXJ2aWNlLCBwcml2YXRlIGJyZWFkY3J1bWJTZXJ2aWNlOiBCcmVhZGNydW1iU2VydmljZSkgewogICAgICAgIHRoaXMuYnJlYWRjcnVtYlNlcnZpY2Uuc2V0SXRlbXMoWwogICAgICAgICAgICB7bGFiZWw6ICdNZXNzYWdlcyd9CiAgICAgICAgXSk7CiAgICB9CgogICAgc2hvd0luZm9WaWFUb2FzdCgpIHsKICAgICAgICB0aGlzLnNlcnZpY2UuYWRkKHtrZXk6ICd0c3QnLCBzZXZlcml0eTogJ2luZm8nLCBzdW1tYXJ5OiAnSW5mbyBNZXNzYWdlJywgZGV0YWlsOiAnUHJpbWVORyByb2Nrcyd9KTsKICAgIH0KCiAgICBzaG93V2FyblZpYVRvYXN0KCkgewogICAgICAgIHRoaXMuc2VydmljZS5hZGQoe2tleTogJ3RzdCcsIHNldmVyaXR5OiAnd2FybicsIHN1bW1hcnk6ICdXYXJuIE1lc3NhZ2UnLCBkZXRhaWw6ICdUaGVyZSBhcmUgdW5zYXZlZCBjaGFuZ2VzJ30pOwogICAgfQoKICAgIHNob3dFcnJvclZpYVRvYXN0KCkgewogICAgICAgIHRoaXMuc2VydmljZS5hZGQoeyBrZXk6ICd0c3QnLCBzZXZlcml0eTogJ2Vycm9yJywgc3VtbWFyeTogJ0Vycm9yIE1lc3NhZ2UnLCBkZXRhaWw6ICdWYWxpZGF0aW9uIGZhaWxlZCcgfSk7CiAgICB9CgogICAgc2hvd1N1Y2Nlc3NWaWFUb2FzdCgpIHsKICAgICAgICB0aGlzLnNlcnZpY2UuYWRkKHsga2V5OiAndHN0Jywgc2V2ZXJpdHk6ICdzdWNjZXNzJywgc3VtbWFyeTogJ1N1Y2Nlc3MgTWVzc2FnZScsIGRldGFpbDogJ01lc3NhZ2Ugc2VudCcgfSk7CiAgICB9CgogICAgc2hvd0luZm9WaWFNZXNzYWdlcygpIHsKICAgICAgICB0aGlzLm1zZ3MgPSBbXTsKICAgICAgICB0aGlzLm1zZ3MucHVzaCh7IHNldmVyaXR5OiAnaW5mbycsIHN1bW1hcnk6ICdJbmZvIE1lc3NhZ2UnLCBkZXRhaWw6ICdQcmltZU5HIHJvY2tzJyB9KTsKICAgIH0KCiAgICBzaG93V2FyblZpYU1lc3NhZ2VzKCkgewogICAgICAgIHRoaXMubXNncyA9IFtdOwogICAgICAgIHRoaXMubXNncy5wdXNoKHsgc2V2ZXJpdHk6ICd3YXJuJywgc3VtbWFyeTogJ1dhcm4gTWVzc2FnZScsIGRldGFpbDogJ1RoZXJlIGFyZSB1bnNhdmVkIGNoYW5nZXMnIH0pOwogICAgfQoKICAgIHNob3dFcnJvclZpYU1lc3NhZ2VzKCkgewogICAgICAgIHRoaXMubXNncyA9IFtdOwogICAgICAgIHRoaXMubXNncy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIHN1bW1hcnk6ICdFcnJvciBNZXNzYWdlJywgZGV0YWlsOiAnVmFsaWRhdGlvbiBmYWlsZWQnIH0pOwogICAgfQoKICAgIHNob3dTdWNjZXNzVmlhTWVzc2FnZXMoKSB7CiAgICAgICAgdGhpcy5tc2dzID0gW107CiAgICAgICAgdGhpcy5tc2dzLnB1c2goeyBzZXZlcml0eTogJ3N1Y2Nlc3MnLCBzdW1tYXJ5OiAnU3VjY2VzcyBNZXNzYWdlJywgZGV0YWlsOiAnTWVzc2FnZSBzZW50JyB9KTsKICAgIH0KfQo