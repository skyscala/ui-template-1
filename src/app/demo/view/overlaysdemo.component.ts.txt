aW1wb3J0IHtDb21wb25lbnQsIE9uSW5pdH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7CmltcG9ydCB7Q29uZmlybWF0aW9uU2VydmljZSwgTWVzc2FnZVNlcnZpY2V9IGZyb20gJ3ByaW1lbmcvYXBpJzsKaW1wb3J0IHtQcm9kdWN0fSBmcm9tICcuLi9kb21haW4vcHJvZHVjdCc7CmltcG9ydCB7UHJvZHVjdFNlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2UvcHJvZHVjdHNlcnZpY2UnOwppbXBvcnQge0JyZWFkY3J1bWJTZXJ2aWNlfSBmcm9tICcuLi8uLi9hcHAuYnJlYWRjcnVtYi5zZXJ2aWNlJzsKCkBDb21wb25lbnQoewogICAgdGVtcGxhdGVVcmw6ICcuL292ZXJsYXlzZGVtby5jb21wb25lbnQuaHRtbCcsCiAgICBzdHlsZVVybHM6IFsnLi9vdmVybGF5c2RlbW8uc2NzcyddLAogICAgcHJvdmlkZXJzOiBbQ29uZmlybWF0aW9uU2VydmljZSwgTWVzc2FnZVNlcnZpY2VdCn0pCmV4cG9ydCBjbGFzcyBPdmVybGF5c0RlbW9Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQgewoKICAgIGltYWdlczogYW55W107CgogICAgZGlzcGxheTogYm9vbGVhbjsKCiAgICBwcm9kdWN0czogUHJvZHVjdFtdOwoKICAgIHNlbGVjdGVkUHJvZHVjdDogUHJvZHVjdDsKCiAgICB2aXNpYmxlU2lkZWJhcjE7CgogICAgdmlzaWJsZVNpZGViYXIyOwoKICAgIHZpc2libGVTaWRlYmFyMzsKCiAgICB2aXNpYmxlU2lkZWJhcjQ7CgogICAgdmlzaWJsZVNpZGViYXI1OwoKICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcHJvZHVjdFNlcnZpY2U6IFByb2R1Y3RTZXJ2aWNlLCBwcml2YXRlIGNvbmZpcm1hdGlvblNlcnZpY2U6IENvbmZpcm1hdGlvblNlcnZpY2UsCiAgICAgICAgICAgICAgICBwcml2YXRlIG1lc3NhZ2VTZXJ2aWNlOiBNZXNzYWdlU2VydmljZSwgcHJpdmF0ZSBicmVhZGNydW1iU2VydmljZTogQnJlYWRjcnVtYlNlcnZpY2UpIHsKICAgICAgICB0aGlzLmJyZWFkY3J1bWJTZXJ2aWNlLnNldEl0ZW1zKFsKICAgICAgICAgICAge2xhYmVsOiAnT3ZlcmxheSd9CiAgICAgICAgXSk7CiAgICB9CgogICAgbmdPbkluaXQoKSB7CiAgICAgICAgdGhpcy5wcm9kdWN0U2VydmljZS5nZXRQcm9kdWN0c1NtYWxsKCkudGhlbihwcm9kdWN0cyA9PiB0aGlzLnByb2R1Y3RzID0gcHJvZHVjdHMpOwoKICAgICAgICB0aGlzLmltYWdlcyA9IFtdOwogICAgICAgIHRoaXMuaW1hZ2VzLnB1c2goewogICAgICAgICAgICBzb3VyY2U6ICdhc3NldHMvZGVtby9pbWFnZXMvc29wcmFub3Mvc29wcmFub3MxLmpwZycsCiAgICAgICAgICAgIHRodW1ibmFpbDogJ2Fzc2V0cy9kZW1vL2ltYWdlcy9zb3ByYW5vcy9zb3ByYW5vczFfc21hbGwuanBnJywgdGl0bGU6ICdTb3ByYW5vcyAxJwogICAgICAgIH0pOwogICAgICAgIHRoaXMuaW1hZ2VzLnB1c2goewogICAgICAgICAgICBzb3VyY2U6ICdhc3NldHMvZGVtby9pbWFnZXMvc29wcmFub3Mvc29wcmFub3MyLmpwZycsCiAgICAgICAgICAgIHRodW1ibmFpbDogJ2Fzc2V0cy9kZW1vL2ltYWdlcy9zb3ByYW5vcy9zb3ByYW5vczJfc21hbGwuanBnJywgdGl0bGU6ICdTb3ByYW5vcyAyJwogICAgICAgIH0pOwogICAgICAgIHRoaXMuaW1hZ2VzLnB1c2goewogICAgICAgICAgICBzb3VyY2U6ICdhc3NldHMvZGVtby9pbWFnZXMvc29wcmFub3Mvc29wcmFub3MzLmpwZycsCiAgICAgICAgICAgIHRodW1ibmFpbDogJ2Fzc2V0cy9kZW1vL2ltYWdlcy9zb3ByYW5vcy9zb3ByYW5vczNfc21hbGwuanBnJywgdGl0bGU6ICdTb3ByYW5vcyAzJwogICAgICAgIH0pOwogICAgICAgIHRoaXMuaW1hZ2VzLnB1c2goewogICAgICAgICAgICBzb3VyY2U6ICdhc3NldHMvZGVtby9pbWFnZXMvc29wcmFub3Mvc29wcmFub3M0LmpwZycsCiAgICAgICAgICAgIHRodW1ibmFpbDogJ2Fzc2V0cy9kZW1vL2ltYWdlcy9zb3ByYW5vcy9zb3ByYW5vczRfc21hbGwuanBnJywgdGl0bGU6ICdTb3ByYW5vcyA0JwogICAgICAgIH0pOwogICAgfQoKICAgIGNvbmZpcm0xKCkgewogICAgICAgIHRoaXMuY29uZmlybWF0aW9uU2VydmljZS5jb25maXJtKHsKICAgICAgICAgICAga2V5OiAnY29uZmlybTEnLAogICAgICAgICAgICBtZXNzYWdlOiAnQXJlIHlvdSBzdXJlIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24_JwogICAgICAgIH0pOwogICAgfQoKICAgIGNvbmZpcm0yKGV2ZW50OiBFdmVudCkgewogICAgICAgIHRoaXMuY29uZmlybWF0aW9uU2VydmljZS5jb25maXJtKHsKICAgICAgICAgICAga2V5OiAnY29uZmlybTInLAogICAgICAgICAgICB0YXJnZXQ6IGV2ZW50LnRhcmdldCwKICAgICAgICAgICAgbWVzc2FnZTogJ0FyZSB5b3Ugc3VyZSB0aGF0IHlvdSB3YW50IHRvIHByb2NlZWQ_JywKICAgICAgICAgICAgaWNvbjogJ3BpIHBpLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlJywKICAgICAgICAgICAgYWNjZXB0OiAoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VTZXJ2aWNlLmFkZCh7c2V2ZXJpdHk6ICdpbmZvJywgc3VtbWFyeTogJ0NvbmZpcm1lZCcsIGRldGFpbDogJ1lvdSBoYXZlIGFjY2VwdGVkJ30pOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWplY3Q6ICgpID0-IHsKICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2UuYWRkKHtzZXZlcml0eTogJ2Vycm9yJywgc3VtbWFyeTogJ1JlamVjdGVkJywgZGV0YWlsOiAnWW91IGhhdmUgcmVqZWN0ZWQnfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KfQo